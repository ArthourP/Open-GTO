/*

	About: custom pickups
	Author: ziggi
	Thanks: Dmitry Frolov for coordinates

*/

enum e_Pickup_Info {
	pickup_model,
	Float:pickup_x,
	Float:pickup_y,
	Float:pickup_z,
	pickup_world,
	pickup_id,
	pickup_time,
};

static pickups_array[][e_Pickup_Info] = {
	// armour
	{1242, -2511.776367, 776.052978, 34.853935, 0},
	{1242, -2511.776367, 776.052978, 34.853935, 0},
	{1242, 2770.699462, 598.954406, 5.432977, 0},
	{1242, 2377.588378, -1685.439819, 13.619550, 0},
	{1242, 423.330352, 2473.769531, 16.500000, 0},
	{1242, 1374.664184, 2318.559814, 10.820312, 0},
	{1242, 2067.892333, -2543.109619, 13.546875, 0},
	{1242, 153.439270, -1961.402587, 3.773437, 0},
	{1242, -1558.935180, -2722.572509, 48.743457, 0},
	{1242, -2560.802001, -10.487899, 12.609375, 0},
	{1242, -1966.538940, 882.815551, 42.109680, 0},
	{1242, 1215.490478, -1916.523315, 30.788236, 0},
	{1242, 2255.333007, 2341.285156, 10.820312, 0},
	{1242, -413.973388, 1340.039184, 13.161015, 0},
	{1242, -2490.974609, 111.115447, 25.867187, 0},
	{1242, 2923.314208, 1705.384399, 8.458881, 0},
	{1242, -824.417846, 1822.617553, 7.000007, 0},
	{1242, -772.431945, 2423.604248, 157.087188, 0},
	{1242, 231.913864, 1934.772705, 33.898437, 0},
	{1242, 294.284851, 1820.691894, 4.710937, 0},
	{1242, 224.804534, 1815.837524, 7.083276, 0},
	{1242, -77.818168, 1227.613769, 22.440261, 0},
	{1242, -727.849670, 1534.645996, 39.784027, 0},
	{1242, -823.695800, 1783.330932, 64.275466, 0},
	{1242, -810.245117, 2428.930664, 156.551422, 0},
	{1242, -1074.128662, 2932.888916, 45.353988, 0},
	{1242, -2621.205566, 2240.719970, 4.578860, 0},
	{1242, -2188.291992, 2412.078857, 4.735194, 0},
	{1242, -2688.898193, 949.832092, 54.004146, 0},
	{1242, -2207.396972, 701.489562, 49.015411, 0},
	{1242, -1923.109252, 421.796234, 34.757476, 0},
	{1242, -1866.672119, 105.744636, 15.482389, 0},
	{1242, -1461.074096, -1570.278564, 101.750000, 0},
	{1242, -1846.538085, -1710.717651, 41.110443, 0},
	{1242, -853.253356, -2076.270996, 73.228141, 0},
	{1242, -1113.494506, -1637.204223, 76.367187, 0},
	{1242, -369.818542, -1418.009765, 25.726562, 0},
	{1242, -379.365997, -1035.806396, 59.044414, 0},
	{1242, -72.314170, -1181.649414, 4.792905, 0},
	{1242, -557.902832, -506.056976, 24.547266, 0},
	{1242, -517.851318, 310.972930, 0.185473, 0},
	{1242, 1139.261352, -1768.582763, 16.593750, 0},
	{1242, 708.061889, -1487.741333, 2.412978, 0},
	{1242, 731.736938, -1275.975585, 17.648437, 0},
	{1242, 1246.647338, -2497.278076, 1.763546, 0},
	{1242, 2778.408447, -2379.873535, 16.224384, 0},
	{1242, 2642.411376, -2051.224121, 13.732213, 0},
	{1242, 2521.821777, -1225.320556, 39.015625, 0},
	{1242, 2498.914794, -942.877868, 82.262138, 0},
	{1242, 317.470092, -1330.811401, 14.414331, 0},
	{1242, -846.242980, -658.171936, 127.008178, 0},
	{1242, -763.160766, -740.629394, 153.213760, 0},
	{1242, -1920.371582, 2539.181640, 41.498527, 0},
	{1242, -1477.914062, 2641.511962, 58.787948, 0},
	{1242, -904.401000, 2677.600097, 42.052322, 0},
	{1242, -1709.017456, 404.793212, 7.418982, 0},
	{1242, -1738.574340, 533.016601, 33.831912, 0},
	{1242, -1680.671386, 1030.901855, 56.906250, 0},
	{1242, 2766.774169, -1191.017700, 69.408546, 0},
	{1242, 2397.842285, -2294.835449, 6.062500, 0},
	{1242, 2189.373046, -2226.099121, 15.171091, 0},
	{1242, 2239.709472, -2175.906982, 13.203166, 0},
	{1242, 1161.551758, 725.133667, 12.669158, 0},
	{1242, -2238.135742, -1712.515502, 480.866577, 0},
	{1242, -2696.397949, 1595.150878, 217.273895, 0},
	// parachute
	{371, -782.126953, -739.272766, 156.926193, 0},
	{371, -1278.723144, 976.799072, 139.273437, 0},
	{371, -1520.083374, 676.267150, 139.273437, 0},
	{371, -2237.728271, -1715.489746, 480.867309, 0},
	{371, -2694.185058, 1595.159667, 217.273895, 0},
	{371, 1710.3359, 1614.3585, 10.1191, 0},
	{371, 1964.4523, 1917.0341, 130.9375, 0},
	{371, 2055.7258, 2395.8589, 150.4766, 0},
	{371, 2265.0120, 1672.3837, 94.9219, 0},
	{371, 2265.9739, 1623.4060, 94.9219, 0},
	// health
	{1240, 2034.0259, -1407.9951, 17.1690, 0}
};

Pickup_OnGameModeInit()
{
	for (new i = 0; i < sizeof(pickups_array); i++) {
		Pickup_Create(i);
	}
	return 1;
}

Pickup_OnPlayerPickUpPickup(playerid, pickupid)
{
	new id = -1;

	for (new i = 0; i < sizeof(pickups_array); i++) {
		if (pickupid == pickups_array[i][pickup_id]) {
			id = i;
			break;
		}
	}

	if (id == -1) {
		return 0;
	}
	
	switch (pickups_array[id][pickup_model]) {
		// armour
		case 1242: {
			SetPlayerArmour(playerid, 100);
		}
		// parachute
		case 371: {
			GivePlayerWeapon(playerid, 46, 1);
		}
		// health
		case 1240: {
			SetPlayerMaxHealth(playerid);
		}
	}

	pickups_array[id][pickup_time] = gettime();

	PlayerPlaySoundOnPlayer(playerid, 1150);
	DestroyPickup(pickupid);
	return 1;
}

Pickup_Update()
{
	new time = gettime();

	for (new i = 0; i < sizeof(pickups_array); i++) {
		if (pickups_array[i][pickup_time] == -1) {
			continue;
		}

		if (time >= pickups_array[i][pickup_time] + PICKUP_UPDATE_TIME) {
			Pickup_Create(i);
		}
	}
}

stock Pickup_Create(id)
{
	pickups_array[id][pickup_id] = CreatePickup(pickups_array[id][pickup_model], 1,
		pickups_array[id][pickup_x], pickups_array[id][pickup_y], pickups_array[id][pickup_z],
		pickups_array[id][pickup_world]);
	
	pickups_array[id][pickup_time] = -1;
}
